#!/bin/bash
#import modules
echo "++Importing modules...++"
module add python-2.7.10-gcc python-2.7.10-intel
module add python27-modules-gcc
module add emboss-6.5.7
echo "++Modules were imported!++"

# for each file generate its own bucket and put there files prepared for FARFAR prediction
# [format: target_chainID template_chainID] in pairs folder (those files can be generated by SimilarityOfFastas tool)

echo "++Starting prediction loop++"
for pairs in ../pairs/*; do
	filename=$(echo $pairs | cut -d/ -f3 | cut -d. -f1)
	echo "	Starting python script for bucket ${filename}" 
	python connect_scripts.py -f ${pairs}
	rm -rf ../prediction/${filename}
	mkdir ../prediction/${filename}
	mv ../prediction/????_?_????_? ../prediction/${filename}
done

